cmdline
skipx
install
cdrom

logging --level=info

lang en_US.UTF-8
keyboard us
timezone --utc Etc/UTC

network --activate --onboot yes --device eth0 --bootproto dhcp --noipv6

rootpw  --plaintext vagrant
authconfig --enableshadow --passalgo=sha512

firewall --enabled --service=ssh,http,https --port=8080:tcp,8443:tcp
selinux --disabled

bootloader --location=mbr
zerombr
clearpart --all --initlabel
autopart

reboot

%packages --nobase
@core --nodefaults
%end

%post
yum -y upgrade

useradd --create-home --user-group --groups wheel vagrant
echo "vagrant" | passwd --stdin vagrant

echo "vagrant ALL=(ALL) NOPASSWD: ALL" > /etc/sudoers.d/vagrant
echo "Defaults !requiretty" >> /etc/sudoers.d/vagrant
chmod 0440 /etc/sudoers.d/vagrant

mkdir -pm 700 ~vagrant/.ssh
curl -sSL -o ~vagrant/.ssh/authorized_keys https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub
chmod 0600 ~vagrant/.ssh/authorized_keys
chown -R vagrant:vagrant ~vagrant/.ssh
%end
